<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TapDay World</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #0b1d0f;
}
canvas {
  display: block;
}
#ui {
  position: fixed;
  top: 10px;
  left: 10px;
  background: rgba(0,0,0,0.5);
  color: #fff;
  padding: 10px 14px;
  border-radius: 12px;
  font-family: Arial;
}
button {
  margin-top: 6px;
  width: 100%;
}
</style>
</head>

<body>

<div id="ui">
  üí∞ <span id="money">1500</span><br>
  ‚è∞ <span id="time">–î–µ–Ω—å</span><br>
  <button onclick="buildBusiness()">–ü–æ–±—É–¥—É–≤–∞—Ç–∏ –±—ñ–∑–Ω–µ—Å</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let camX = 0;
let camY = 0;
let zoom = 1;

let money = 1500;
let isDay = true;

const tiles = [];
const TILE = 64;
const MAP = 80;

// === –ì–ï–ù–ï–†–ê–¶–Ü–Ø –ö–ê–†–¢–ò ===
for (let y = 0; y < MAP; y++) {
  for (let x = 0; x < MAP; x++) {
    const n = Math.random();
    tiles.push({
      x, y,
      type: n < 0.18 ? "water" : "grass",
      business: false
    });
  }
}

// === –†–ï–ù–î–ï–† ===
function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.save();
  ctx.translate(canvas.width/2 + camX, canvas.height/2 + camY);
  ctx.scale(zoom, zoom);

  tiles.forEach(t => {
    const px = (t.x - t.y) * TILE;
    const py = (t.x + t.y) * TILE/2;

    if (t.type === "water") {
      ctx.fillStyle = "#2b6cb0";
    } else {
      ctx.fillStyle = "#3fa34d";
    }

    ctx.beginPath();
    ctx.moveTo(px, py);
    ctx.lineTo(px + TILE, py + TILE/2);
    ctx.lineTo(px, py + TILE);
    ctx.lineTo(px - TILE, py + TILE/2);
    ctx.closePath();
    ctx.fill();

    if (t.business) {
      ctx.fillStyle = "#222";
      ctx.fillRect(px - 10, py + 20, 20, 20);
    }
  });

  // –Ω—ñ—á
  if (!isDay) {
    ctx.fillStyle = "rgba(0,0,40,0.4)";
    ctx.fillRect(-5000,-5000,10000,10000);
  }

  ctx.restore();

  requestAnimationFrame(draw);
}

draw();

// === –£–ü–†–ê–í–õ–Ü–ù–ù–Ø –ö–ê–†–¢–û–Æ ===
let dragging = false;
let lastX, lastY;

canvas.onmousedown = e => {
  dragging = true;
  lastX = e.clientX;
  lastY = e.clientY;
};

canvas.onmouseup = () => dragging = false;

canvas.onmousemove = e => {
  if (!dragging) return;
  camX += e.clientX - lastX;
  camY += e.clientY - lastY;
  lastX = e.clientX;
  lastY = e.clientY;
};

canvas.onwheel = e => {
  zoom += e.deltaY * -0.001;
  zoom = Math.min(Math.max(zoom, 0.4), 2);
};

// === –ë–Ü–ó–ù–ï–° ===
function buildBusiness() {
  const tile = tiles.find(t => t.type === "grass" && !t.business);
  if (!tile || money < 200) return;
  tile.business = true;
  money -= 200;
  document.getElementById("money").innerText = money;
}

// === –î–ï–ù–¨ / –ù–Ü–ß ===
setInterval(() => {
  isDay = !isDay;
  document.getElementById("time").innerText = isDay ? "–î–µ–Ω—å" : "–ù—ñ—á";
}, 12000);

// === –î–û–•–Ü–î ===
setInterval(() => {
  const count = tiles.filter(t => t.business).length;
  money += count * 5;
  document.getElementById("money").innerText = money;
}, 3000);
</script>

</body>
</html>
