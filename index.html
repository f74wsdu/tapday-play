<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TapDay Play PRO - Server Edition</title>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, doc, getDoc, setDoc, updateDoc, getDocs, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

// ======== FIREBASE CONFIGURE =======
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
window.db = db; // –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –≤ –∫–æ–Ω—Å–æ–ª—ñ
</script>

<style>
body { margin:0; font-family:Arial,sans-serif; background:#0b0b0b; color:white; text-align:center; }
h1 { margin:20px; color:#ffd700; text-shadow:0 0 10px #ffcc00; }
#balance { font-size:32px; margin:15px; }
#tapBtn { width:180px;height:180px;border-radius:50%; font-size:32px; background:linear-gradient(45deg,#ff9800,#ffd700); border:none; box-shadow:0 0 30px #ffcc00; cursor:pointer; }
button.actionBtn { margin:10px;padding:10px 20px;border:none;border-radius:10px;background:#222;color:white; cursor:pointer; }
#leaderboard { margin-top:20px; font-size:16px; color:#ffcc00; text-align:left; max-width:300px; margin-left:auto;margin-right:auto; }
</style>
</head>
<body>
<h1>üî• TapDay Play PRO - Global</h1>
<div id="balance">üí∞ Balance: 0</div>
<button id="tapBtn">TAP</button>
<div id="leaderboard">
<h3>üåç Global Leaderboard</h3>
<div id="topPlayers">Loading...</div>
</div>

<script type="module">
import { collection, doc, setDoc, getDoc, updateDoc, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

let balance = parseFloat(localStorage.getItem("balance"))||0;
let playerId = "player_"+Math.floor(Math.random()*1000000); // –ø—Ä–æ—Å—Ç–∏–π —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID
const balanceEl = document.getElementById("balance");
const tapBtn = document.getElementById("tapBtn");
const topPlayers = document.getElementById("topPlayers");

function updateUI(){
  balanceEl.textContent = `üí∞ Balance: ${balance.toFixed(2)} $`;
  localStorage.setItem("balance",balance);
}
updateUI();

// ===== TAP =====
tapBtn.onclick=()=>{
  balance+=0.01;
  updateUI();
  sendBalanceToServer();
}

// ===== SEND BALANCE TO FIRESTORE =====
async function sendBalanceToServer(){
  const docRef = doc(db,"players",playerId);
  const docSnap = await getDoc(docRef);
  if(docSnap.exists()){
    await updateDoc(docRef,{balance:balance});
  } else {
    await setDoc(docRef,{balance:balance,created:Date.now()});
  }
}

// ===== GLOBAL LEADERBOARD =====
const leaderboardQuery = query(collection(db,"players"),orderBy("balance","desc"),limit(5));
onSnapshot(leaderboardQuery,(snapshot)=>{
  topPlayers.innerHTML="";
  snapshot.forEach(doc=>{
    topPlayers.innerHTML+=`<div>${doc.id}: ${doc.data().balance.toFixed(2)} $</div>`;
  });
});

// ===== AUTO SEND EVERY 5 SEC =====
setInterval(sendBalanceToServer,5000);
</script>
</body>
</html>
